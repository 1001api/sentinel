(()=>{function E(t){return t?.map(e=>new Date(e.Timestamp).toDateString())??[]}function s(t){return t?.map(e=>e.Total)??[]}function h(t){return t?.map(e=>e.EventType)??[]}function u(t){let e=[];return t?.map(a=>e.push({x:a.EventLabel,y:a.Total})),e}var x=1e4,l=document.getElementById("project-id")?.textContent,r=l?JSON.parse(l):null,i=document.getElementById("weekly-events")?.textContent,f=i?JSON.parse(i):[],c=document.getElementById("event-type-chart")?.textContent,m=c?JSON.parse(c):[],d=document.getElementById("event-label-chart")?.textContent,v=d?JSON.parse(d):[],T=E(f),k=s(f),C=h(m),S=s(m),B=u(v),p=document.getElementById("weekly-event-total"),L={chart:{height:"300px",maxWidth:"100%",type:"area",dropShadow:{enabled:!0},toolbar:{show:!1},animations:{enabled:!1},zoom:{enabled:!1}},tooltip:{enabled:!0,x:{show:!0}},fill:{type:"gradient",gradient:{opacityFrom:.55,opacityTo:0,shade:"#1C64F2",gradientToColors:["#1C64F2"]}},dataLabels:{enabled:!1,style:{fontFamily:"Space Grotesk"}},stroke:{width:6},grid:{show:!1,strokeDashArray:4,padding:{left:2,right:2,top:0}},series:[{name:"Events",data:k,color:"#1A56DB"}],xaxis:{categories:T,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1}},n={series:S,chart:{height:"380px",width:"100%",type:"pie",animations:{enabled:!1}},stroke:{colors:["white"],lineCap:""},plotOptions:{pie:{labels:{show:!0},size:"100%",dataLabels:{offset:-25}}},labels:C,dataLabels:{enabled:!0,style:{fontFamily:"Space Grotesk"}},legend:{position:"bottom",fontFamily:"Space Grotesk, sans-serif"},xaxis:{axisTicks:{show:!0},axisBorder:{show:!0}}},o={series:[{name:"X Event Fired",data:B}],chart:{type:"bar",height:"350px",fontFamily:"Space Grotesk, sans-serif",toolbar:{show:!1},animations:{enabled:!1}},plotOptions:{bar:{distributed:!0,horizontal:!1,columnWidth:"70%",borderRadiusApplication:"end",borderRadius:8}},tooltip:{shared:!0,intersect:!1,style:{fontFamily:"Space Grotesk, sans-serif"}},states:{hover:{filter:{type:"darken",value:1}}},stroke:{show:!0,width:0,colors:["transparent"]},grid:{show:!1,strokeDashArray:4,padding:{left:2,right:2,top:-14}},dataLabels:{enabled:!0},legend:{show:!1},xaxis:{floating:!0,labels:{show:!1,style:{fontFamily:"Space Grotesk, sans-serif",cssClass:"text-xs font-light fill-gray-500 dark:fill-gray-400"}},axisBorder:{show:!0},axisTicks:{show:!0}},yaxis:{show:!1},fill:{opacity:1}},y=new ApexCharts(document.getElementById("area-chart"),L),w=new ApexCharts(document.getElementById("pie-chart"),n),g=new ApexCharts(document.getElementById("column-chart"),o);y.render();w.render();g.render();setInterval(function(){Promise.allSettled([A(y),F(w),I(g)])},x);function A(t){$.ajax({url:`/api/json/event/chart/${r}`,type:"GET",success:function(e){let a=s(e.Time);p&&(p.innerText=e.Total??0),t.updateSeries([{name:"Events",data:a,color:"#1A56DB"}])},error:function(){console.log("Error fetching new chart data")}})}function F(t){$.ajax({url:`/api/json/event-type/chart/${r}`,type:"GET",success:function(e){let a=s(e),b=h(e);n.labels=b,n.series=a,t.updateOptions(n)},error:function(){console.log("Error fetching new chart data")}})}function I(t){$.ajax({url:`/api/json/event-label/chart/${r}`,type:"GET",success:function(e){let a=u(e);o.series=[{name:"X Event Fired",data:a}],t.updateOptions(o)},error:function(){console.log("Error fetching new chart data")}})}})();
